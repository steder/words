<!DOCTYPE html>
<html>

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width; initial-scale=1.0;" />
<title>The Scrabbleator!</title>
<link href="static/style.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/ico" href="favicon.ico" />
<script type="text/javascript" src="static/jquery-1.7.1.js"></script>
<script type="text/javascript" src="static/words.js"></script>
<script type="text/javascript">
// a function to check an assertion against the server
var checkAssertion = function (assertion) {
  $.ajax({
    url: "/process_assertion",
    type: "post",
    dataType: "json",
    data: {
      assertion: assertion,
      audience: window.location.protocol + "//" + window.location.host
    },
    success: function(data, textStatus, jqXHR) {
      console.log(JSON.stringify(data, null, 4));
      // TODO: set a cookie?
    },
    error: function(jqXHR, textStatus, errorThrown) {
      var resp = jqXHR.responseText ? JSON.parse(jqXHR.responseText) : errorThrown;
      console.log(resp);
    }
  });
};

var login = function() {
    var requiredEmail = document.getElementById("requiredEmail").value;
    console.log("required email: " + requiredEmail);

    var getAssertion = function(assertion) {
        if (assertion) {
            // This code will be invoked once the user has successfully
            // selected an email address they control to sign in with.
            console.log("user logged in now verify the assertion: ...");
            console.log("assertion: " + String(assertion));
        } else {
            // something went wrong!  the user isn't logged in.
            console.log("user isn't logged in: ...");
        }
    };

    navigator.id.get(getAssertion, {silent: false,
                                    allowPersistent: true,
                                    requiredEmail: requiredEmail});
};


var ready = function () {
    penzilla.dictionary = new penzilla.words.Dictionary(
        "letters",
        "results",
        "scrabbleate"
    );

    //$("#signin_button").click(login);
};

$("document").ready(ready);
</script>
<script src="https://browserid.org/include.js" type="text/javascript"></script>
<script type="text/javascript" src="static/analytics.js">
</script>
</head>

<body>
	<header>
		<div id="title">The Scrabbleator</div>
		<div id="subtitle">... because games are more fun when you cheat!</div>
	</header>

	<form id="scrabble_input" class="centered" action="javascript:penzilla.words.getScrabbleWords()">
		<label for="letters">Enter your scrabble letters and we'll let you know which words you can play</label>
		<div class="centered">
          <input id="letters" type="text" required>
          <button id="scrabbleate" type="submit">Scrabbleate!</button>
          <div id="spinner" class="centered hidden">
            <img src="static/ajax-loader.gif"/>
          </div>
        </div>
	</form>
    <form id="login_form" action="javascript:login()">
      <input type="checkbox" id="silent">&nbsp;Silent <br/>
      <input type="checkbox" id="allowPersistent">&nbsp;Allow persistent sign-in <br/>
      <input type="text" id="requiredEmail" width="80">&nbsp;Require a specific email <br/>
      <button id="signin_button" class="centered" action="javascript:">
        <img src="static/sign_in_green.png" class="centered"/>
      </button>
    </form>
	<table id="results" class="centered hidden">
		<thead>
			<tr>
				<th>Word</th>
				<th>Points</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>Ted</td>
				<td>5</td>
			</tr>
			<tr>
				<td>Carolyn</td>
				<td>100</td>
			</tr>
			<tr>
				<td>SolaBear</td>
				<td>250</td>
			</tr>
		</tbody>
	</table>
</body>
</html>
